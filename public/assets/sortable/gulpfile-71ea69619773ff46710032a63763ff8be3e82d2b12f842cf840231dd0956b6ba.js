const gulp=require("gulp"),uglify=require("gulp-uglify"),rename=require("gulp-rename"),each=require("gulp-each"),path=require("path"),pump=require("pump"),package=require("./package.json"),name=package.exportName,versionExp=/(?<=\"version\":\s{0,}\")(.{0,})(?=\")/i;gulp.task("version",function(){let e=package.version;return pump([gulp.src("./*.json"),each(function(p,r,u){let a=p.match(versionExp);a&&(a=a[0]),p=p.replace(versionExp,e),a&&a!==e&&console.info(`Updated version in ${path.basename(r.history[0])}:\t${a} -> ${e}`),u(null,p)}),gulp.dest("./")])}),gulp.task("minify",function(){return pump([gulp.src(`./${name}.js`),uglify({output:{preamble:`/*! ${name} ${package.version} - ${package.license} | ${package.repository.url} */\n`}}),rename({suffix:".min"}),gulp.dest("./")])}),gulp.task("build",gulp.series("version","minify"));