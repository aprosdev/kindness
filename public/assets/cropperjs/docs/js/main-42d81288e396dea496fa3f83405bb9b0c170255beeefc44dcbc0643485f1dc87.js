window.onload=function(){"use strict";var e,t=window.Cropper,o=window.URL||window.webkitURL,a=document.querySelector(".img-container").getElementsByTagName("img").item(0),n=document.getElementById("download"),d=document.getElementById("actions"),c=document.getElementById("dataX"),i=document.getElementById("dataY"),r=document.getElementById("dataHeight"),l=document.getElementById("dataWidth"),s=document.getElementById("dataRotate"),p=document.getElementById("dataScaleX"),u=document.getElementById("dataScaleY"),m={aspectRatio:16/9,preview:".img-preview",ready:function(e){console.log(e.type)},cropstart:function(e){console.log(e.type,e.detail.action)},cropmove:function(e){console.log(e.type,e.detail.action)},cropend:function(e){console.log(e.type,e.detail.action)},crop:function(e){var t=e.detail;console.log(e.type),c.value=Math.round(t.x),i.value=Math.round(t.y),r.value=Math.round(t.height),l.value=Math.round(t.width),s.value="undefined"!=typeof t.rotate?t.rotate:"",p.value="undefined"!=typeof t.scaleX?t.scaleX:"",u.value="undefined"!=typeof t.scaleY?t.scaleY:""},zoom:function(e){console.log(e.type,e.detail.ratio)}},g=new t(a,m),y=a.src,f="image/jpeg",v="cropped.jpg";$('[data-toggle="tooltip"]').tooltip(),document.createElement("canvas").getContext||$('button[data-method="getCroppedCanvas"]').prop("disabled",!0),"undefined"==typeof document.createElement("cropper").style.transition&&($('button[data-method="rotate"]').prop("disabled",!0),$('button[data-method="scale"]').prop("disabled",!0)),"undefined"==typeof n.download&&(n.className+=" disabled",n.title="Your browser does not support download"),d.querySelector(".docs-toggles").onchange=function(e){var o,n,d,c,i=e||window.event,r=i.target||i.srcElement;g&&("label"===r.tagName.toLowerCase()&&(r=r.querySelector("input")),d="checkbox"===r.type,c="radio"===r.type,(d||c)&&(d?(m[r.name]=r.checked,o=g.getCropBoxData(),n=g.getCanvasData(),m.ready=function(){console.log("ready"),g.setCropBoxData(o).setCanvasData(n)}):(m[r.name]=r.value,m.ready=function(){console.log("ready")}),g.destroy(),g=new t(a,m)))},d.querySelector(".docs-buttons").onclick=function(t){var d,c,i,r,l=t||window.event,s=l.target||l.srcElement;if(g){for(;s!==this&&!s.getAttribute("data-method");)s=s.parentNode;if(!(s===this||s.disabled||s.className.indexOf("disabled")>-1)&&(r={method:s.getAttribute("data-method"),target:s.getAttribute("data-target"),option:s.getAttribute("data-option")||undefined,secondOption:s.getAttribute("data-second-option")||undefined},d=g.cropped,r.method)){if("undefined"!=typeof r.target&&(i=document.querySelector(r.target),!s.hasAttribute("data-option")&&r.target&&i))try{r.option=JSON.parse(i.value)}catch(l){console.log(l.message)}switch(r.method){case"rotate":d&&m.viewMode>0&&g.clear();break;case"getCroppedCanvas":try{r.option=JSON.parse(r.option)}catch(l){console.log(l.message)}"image/jpeg"===f&&(r.option||(r.option={}),r.option.fillColor="#fff")}switch(c=g[r.method](r.option,r.secondOption),r.method){case"rotate":d&&m.viewMode>0&&g.crop();break;case"scaleX":case"scaleY":s.setAttribute("data-option",-r.option);break;case"getCroppedCanvas":c&&($("#getCroppedCanvasModal").modal().find(".modal-body").html(c),n.disabled||(n.download=v,n.href=c.toDataURL(f)));break;case"destroy":g=null,e&&(o.revokeObjectURL(e),e="",a.src=y)}if("object"==typeof c&&c!==g&&i)try{i.value=JSON.stringify(c)}catch(l){console.log(l.message)}}}},document.body.onkeydown=function(e){var t=e||window.event;if(t.target===this&&g&&!(this.scrollTop>300))switch(t.keyCode){case 37:t.preventDefault(),g.move(-1,0);break;case 38:t.preventDefault(),g.move(0,-1);break;case 39:t.preventDefault(),g.move(1,0);break;case 40:t.preventDefault(),g.move(0,1)}};var h=document.getElementById("inputImage");o?h.onchange=function(){var n,d=this.files;g&&d&&d.length&&(n=d[0],/^image\/\w+/.test(n.type)?(f=n.type,v=n.name,e&&o.revokeObjectURL(e),a.src=e=o.createObjectURL(n),g.destroy(),g=new t(a,m),h.value=null):window.alert("Please choose an image file."))}:(h.disabled=!0,h.parentNode.className+=" disabled")};