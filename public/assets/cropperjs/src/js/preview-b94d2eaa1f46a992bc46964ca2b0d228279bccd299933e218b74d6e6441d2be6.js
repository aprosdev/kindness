import{DATA_PREVIEW}from"./constants";import{assign,forEach,getData,getTransforms,removeData,setData,setStyle}from"./utilities";export default{initPreview(){const{crossOrigin:t}=this,{preview:e}=this.options,i=t?this.crossOriginUrl:this.url,s=document.createElement("img");if(t&&(s.crossOrigin=t),s.src=i,this.viewBox.appendChild(s),this.viewBoxImage=s,!e)return;let a=e;"string"==typeof e?a=this.element.ownerDocument.querySelectorAll(e):e.querySelector&&(a=[e]),this.previews=a,forEach(a,e=>{const s=document.createElement("img");setData(e,DATA_PREVIEW,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),t&&(s.crossOrigin=t),s.src=i,s.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',e.innerHTML="",e.appendChild(s)})},resetPreview(){forEach(this.previews,t=>{const e=getData(t,DATA_PREVIEW);setStyle(t,{width:e.width,height:e.height}),t.innerHTML=e.html,removeData(t,DATA_PREVIEW)})},preview(){const{imageData:t,canvasData:e,cropBoxData:i}=this,{width:s,height:a}=i,{width:r,height:h}=t,n=i.left-e.left-t.left,o=i.top-e.top-t.top;this.cropped&&!this.disabled&&(setStyle(this.viewBoxImage,assign({width:r,height:h},getTransforms(assign({translateX:-n,translateY:-o},t)))),forEach(this.previews,e=>{const i=getData(e,DATA_PREVIEW),g=i.width,m=i.height;let l=g,c=m,p=1;s&&(c=a*(p=g/s)),a&&c>m&&(l=s*(p=m/a),c=m),setStyle(e,{width:l,height:c}),setStyle(e.getElementsByTagName("img")[0],assign({width:r*p,height:h*p},getTransforms(assign({translateX:-n*p,translateY:-o*p},t))))}))}};